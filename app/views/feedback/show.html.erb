<%# app/views/feedback/show.html.erb %>
<% content_for :title, "Feedback" %>
<% content_for :navbar, "Feedback" %>
<% content_for :force_navbar_button do %>
  <%= link_to "https://buymeacoffee.com/crmne", target: "_blank", rel: "noopener noreferrer", class: "btn",
      data: {
        controller: "bridge--button",
        bridge_title: "Donate"
      } do %>
    Donate ☕️
  <% end %>
<% end %>

<div class="relative" style="height: calc(100vh - (env(safe-area-inset-top) + env(safe-area-inset-bottom)) - <%= native_app_with_tabs? ? '4rem' : '8rem' %>)" data-controller="tally">
  <%# Loading state %>
  <div class="absolute inset-0 flex items-center justify-center bg-base-200"
       data-tally-loading-indicator>
    <span class="loading loading-spinner loading-lg text-primary"></span>
  </div>

  <iframe
      data-tally-src="https://tally.so/r/31JxWO"
      class="w-full h-full"
      frameborder="0"
      marginheight="0"
      marginwidth="0"
      title="Help us improve Cluster Headache Tracker"
      onload="this.previousElementSibling.style.display = 'none'">
  </iframe>
</div>

<% content_for :head do %>
  <script>
    window.onTallyLoad = function() {
      document.dispatchEvent(new Event('tally-loaded'))
    }
  </script>
  <script async src="https://tally.so/widgets/embed.js" onload="window.onTallyLoad()"></script>
<% end %>
